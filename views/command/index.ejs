<!DOCTYPE html>
<html lang="ja">
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <title><%= title %></title>
        <link rel='stylesheet' href='/stylesheets/style.css' />
        <script src="https://code.jquery.com/jquery-1.12.4.min.js"
            integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ="
            crossorigin="anonymous"></script>

        <script>
            $(function(){
                $('.button').on('click', function(){
                    $(this).toggleClass('active');
                });
            });
        </script>
        <script>
            $(function() {
            var $children = $('.children');
            var original = $children.html();

            $('.parent').change(function() {
                var val1 = $(this).val();

                $children.html(original).find('option').each(function() {
                var val2 = $(this).data('val');
                if (val1 != val2) {
                    $(this).not(':first-child').remove();
                }
                });

                if ($(this).val() === '') {
                $children.attr('disabled', 'disabled');
                } else {
                $children.removeAttr('disabled');
                }

            });
            });
        </script>
    </head>
    <body>
        <head>
            <h1 id="titlename"><%= title %></h1>
        </head>
        <div role="main" class="menuservant">
            <table class="servants">
                <% for (var j=0; j<3; j++) { %> 
                    <% for (var i in content) { %> 
                    <% if (number[j]==content[i].id) { %>
                    <tr>
                        <% var obj = content[i]; %>
                        <th class="name"><%= obj.name %></th>
                        <td><button class="button"><font color=<%=obj.color1 %>><%= obj.c_cards[0] %></font></button></td>
                        <td><button class="button"><font color=<%=obj.color2 %>><%= obj.c_cards[1] %></font></button></td>
                        <td><button class="button"><font color=<%=obj.color3 %>><%= obj.c_cards[2] %></font></button></td>
                        <td><button class="button"><font color=<%=obj.color4 %>><%= obj.c_cards[3] %></font></button></td>
                        <td><button class="button"><font color=<%=obj.color5 %>><%= obj.c_cards[4] %></font></button></td>
                    </tr>
                    <% } %>
                    <% } %>
                <% } %>
            </table>
            <form method="post" action="/command">
            <table>
                <tr>
                    <th>退場メンバー</th>
                    <td>
                        <input type="checkbox" name="before" value=1>前衛<br>
                        <input type="checkbox" name="before" value=2>中衛<br>
                        <input type="checkbox" name="before" value=3>後衛<br>
                    </td>
                </tr>
                <tr>
                    <th>追加メンバー</th>
                    <td>
                        <select class="parent" name="class" required>
                            <option value="" class="msg" disabled selected>-----サーヴァントのクラスを選択-----</option>
                            <option value="5saber">星５セイバー</option>
                            <option value="4saber">星４セイバー</option>
                            <option value="3saber">星３セイバー</option>
                            <option value="5archer">星５アーチャー</option>
                            <option value="4archer">星４アーチャー</option>
                            <option value="3archer">星３アーチャー</option>
                            <option value="2archer">星２アーチャー</option>
                            <option value="1archer">星１アーチャー</option>
                            <option value="5lancer">星５ランサー</option>
                            <option value="4lancer">星４ランサー</option>
                            <option value="3lancer">星３ランサー</option>
                            <option value="2lancer">星２ランサー</option>
                            <option value="1lancer">星１ランサー</option>
                            <option value="5rider">星５ライダー</option>
                            <option value="4rider">星４ライダー</option>
                            <option value="3rider">星３ライダー</option>
                            <option value="2rider">星２ライダー</option>
                            <option value="1rider">星１ライダー</option>
                            <option value="5caster">星５キャスター</option>
                            <option value="4caster">星４キャスター</option>
                            <option value="3caster">星３キャスター</option>
                            <option value="2caster">星２キャスター</option>
                            <option value="1caster">星１キャスター</option>
                            <option value="5assassin">星５アサシン</option>
                            <option value="4assassin">星４アサシン</option>
                            <option value="3assassin">星３アサシン</option>
                            <option value="2assassin">星２アサシン</option>
                            <option value="1assassin">星１アサシン</option>
                            <option value="5berserker">星５バーサーカー</option>
                            <option value="4berserker">星４バーサーカー</option>
                            <option value="3berserker">星３バーサーカー</option>
                            <option value="2berserker">星２バーサーカー</option>
                            <option value="1berserker">星１バーサーカー</option>
                            <option value="5extra">星５エクストラ</option>
                            <option value="4extra">星４エクストラ</option>
                            <option value="0extra">星０エクストラ</option>
                        </select><br>
                        <select class="children" name="after" disabled required>
                            <option value="not_selected" class="msg" disabled selected>-----サーヴァントを選択-----</option>
                                <% for(var i in content2) { %>
                                    <% var obj = content2[i]; %>
                                    <option value=<%= obj.id %> data-val=<%= obj.class %>><%= obj.name %></option>
                                <% } %>
                        </select>
                    </td>
                </tr>
            </table>
            <input type="submit" class="buttons" value="変更">
            </form>
            <input type="button" class="buttons" value="コマンドカードを初期状態に戻す" onclick="window.location.reload();" />
        </div>
        <p class="menutop">説明</p>
        <ul>
            <li class="menuli">使用されたコマンドカードをクリックしてください。クリックされたカードは紫色に変化します。</li>
            <li class="menuli">コマンドカードが埋まったら「コマンドカードを初期状態に戻す」ボタンを押せばリセットされます。（このボタンはただのリロードボタンなので15個全部押し直しても問題ないです）</li>
            <li class="menuli">仕様上、カルデア戦闘服のオーダーチェンジによるメンバー変更には対応していません。ごめんなさい。カルデア戦闘服を使用しないか（横暴）、オダチェン前の使用カードを覚えておくようにお願いします。（なんにせよ横暴）</li>
            <li class="menuli">手元で調べた感じだと、オダチェンしたら、残った2人のカードを使い切ったタイミングでコマンドカードのリセットが起こるみたいなので参考までに。</li>
        </ul>
        <p class="menu"><a href="/">トップに戻る</a></p>
    </body>
</html>